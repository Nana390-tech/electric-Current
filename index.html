<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP 0103 - Electric Current - Reading 6</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { Zap, CheckCircle, XCircle, RefreshCw, Trophy, Download } = lucide;

        const ElectricCurrentLesson = () => {
            const [currentActivity, setCurrentActivity] = useState(0);
            const [points, setPoints] = useState(0);
            const [completedActivities, setCompletedActivities] = useState([]);
            
            const [activity1Answers, setActivity1Answers] = useState({ word1: '', word2: '', word3: '', word4: '', word5: '', word6: '', word7: '', word8: '', word9: '' });
            const [activity1Checked, setActivity1Checked] = useState(false);
            const [activity1Score, setActivity1Score] = useState(null);
            const [selectedBlank1, setSelectedBlank1] = useState(null);
            
            const [activity2Answers, setActivity2Answers] = useState({ a: '', b: '', c: '' });
            const [activity2Checked, setActivity2Checked] = useState(false);
            const [activity2Score, setActivity2Score] = useState(null);
            
            const [activity3Answers, setActivity3Answers] = useState({});
            const [activity3Checked, setActivity3Checked] = useState(false);
            const [activity3Score, setActivity3Score] = useState(null);
            
            const [activity4Answers, setActivity4Answers] = useState({});
            const [activity4Checked, setActivity4Checked] = useState(false);
            const [activity4Score, setActivity4Score] = useState(null);
            const [showFlashcards, setShowFlashcards] = useState(true);
            const [flippedCards, setFlippedCards] = useState({});
            const [selectedBlank4, setSelectedBlank4] = useState(null);
            
            const [activity6Answers, setActivity6Answers] = useState({ para1: '', para2: '', para3: '' });
            const [activity6Checked, setActivity6Checked] = useState(false);
            const [activity6Score, setActivity6Score] = useState(null);
            
            const [activity7Answers, setActivity7Answers] = useState({});
            const [activity7Checked, setActivity7Checked] = useState(false);
            const [activity7Score, setActivity7Score] = useState(null);

            const activity1WordCounts = { 'atom': 2, 'protons': 2, 'neutrons': 2, 'electrons': 2, 'Atoms': 1 };
            const activity4WordCounts = { 'power': 1, 'generators': 1, 'current': 1, 'wires': 1, 'outlets': 1, 'plug in': 1, 'device': 1, 'appliances': 1, 'magnet': 1, 'coil': 1 };

            const activity1WordBank = ['atom', 'protons', 'neutrons', 'electrons', 'Atoms'];
            const activity2Correct = { a: 'protons', b: 'electrons', c: 'Neutrons' };
            const activity4WordBank = ['appliances', 'coil', 'current', 'device', 'generators', 'magnet', 'outlets', 'plug in', 'power', 'wires'];
            const activity4Blanks = ['power', 'generators', 'current', 'wires', 'outlets', 'plug in', 'device', 'appliances', 'magnet', 'coil'];

            const vocabularyCards = [
                { word: 'power', meaning: 'energy supplied to operate electrical devices', arabic: 'ÿ∑ÿßŸÇÿ©' },
                { word: 'generators', meaning: 'machines that produce electricity', arabic: 'ŸÖŸàŸÑÿØÿßÿ™' },
                { word: 'current', meaning: 'the flow of electricity through a wire', arabic: 'ÿ™Ÿäÿßÿ±' },
                { word: 'wires', meaning: 'thin metal threads that carry electricity', arabic: 'ÿ£ÿ≥ŸÑÿßŸÉ' },
                { word: 'outlets', meaning: 'sockets where plugs connect to electricity', arabic: 'ŸÖŸÇÿßÿ®ÿ≥' },
                { word: 'plug in', meaning: 'to connect equipment to electricity supply', arabic: 'ŸäŸàÿµŸÑ ÿ®ÿßŸÑŸÉŸáÿ±ÿ®ÿßÿ°' },
                { word: 'device', meaning: 'a piece of electrical equipment', arabic: 'ÿ¨Ÿáÿßÿ≤' },
                { word: 'appliances', meaning: 'electrical devices used in the home', arabic: 'ÿ£ÿ¨Ÿáÿ≤ÿ©' },
                { word: 'magnet', meaning: 'an object that produces a magnetic field', arabic: 'ŸÖÿ∫ŸÜÿßÿ∑Ÿäÿ≥' },
                { word: 'coil', meaning: 'wire wound in circles or spirals', arabic: 'ŸÖŸÑŸÅ' }
            ];

            const activity3Questions = [
                { num: 1, options: ['Electricity', 'Lightning'], correct: 'Electricity' },
                { num: 2, options: ['neutrons', 'electrons'], correct: 'electrons' },
                { num: 3, options: ['wire', 'energy'], correct: 'energy' },
                { num: 4, options: ['flow', 'charge'], correct: 'flow' },
                { num: 5, options: ['light bulbs', 'electricity'], correct: 'electricity' },
                { num: 6, options: ['lightning', 'power'], correct: 'lightning' },
                { num: 7, options: ['electrons', 'batteries'], correct: 'electrons' },
                { num: 8, options: ['switch', 'energy'], correct: 'energy' },
                { num: 9, options: ['power', 'generate'], correct: 'generate' },
                { num: 10, options: ['wires', 'batteries'], correct: 'wires' },
                { num: 11, options: ['energy', 'power'], correct: 'power' },
                { num: 12, options: ['provides', 'switches'], correct: 'provides' },
                { num: 13, options: ['universe', 'battery'], correct: 'universe' },
                { num: 14, options: ['wires', 'atoms'], correct: 'atoms' },
                { num: 15, options: ['positive', 'negative'], correct: 'negative' },
                { num: 16, options: ['power', 'charge'], correct: 'charge' },
                { num: 17, options: ['positive', 'neutron'], correct: 'positive' },
                { num: 18, options: ['switches', 'charges'], correct: 'charges' },
                { num: 19, options: ['Electrical', 'Electricity'], correct: 'Electricity' },
                { num: 20, options: ['electrons', 'neutrons'], correct: 'electrons' }
            ];

            const activity6Headings = ['What is electricity?', 'How electricity works.', 'Generating electricity.'];
            const activity6Correct = { para1: 'What is electricity?', para2: 'How electricity works.', para3: 'Generating electricity.' };

            const activity7Questions = [
                { id: 1, question: "What is electricity?", options: ["The flow of electrons", "The flow of water", "The flow of air", "The flow of light"], correct: "The flow of electrons" },
                { id: 2, question: "Where can we see electricity in nature?", options: ["In lightning", "In rain", "In wind", "In snow"], correct: "In lightning" },
                { id: 3, question: "What is lightning?", options: ["Many electrons moving through air", "Water falling from clouds", "Wind blowing fast", "Clouds touching each other"], correct: "Many electrons moving through air" },
                { id: 4, question: "How do scientists send electricity to our homes?", options: ["Through wires", "Through the air", "Through water pipes", "Through the ground"], correct: "Through wires" },
                { id: 5, question: "What does electricity power in the modern world?", options: ["Heaters, light bulbs, and computers", "Only light bulbs", "Only heaters", "Only computers"], correct: "Heaters, light bulbs, and computers" }
            ];

            const checkActivity1 = () => {
                let correct = 0;
                if (activity1Answers.word1 === 'atom') correct++;
                const threeParts = new Set([activity1Answers.word2, activity1Answers.word3, activity1Answers.word4]);
                if (threeParts.size === 3 && ['protons', 'neutrons', 'electrons'].every(w => threeParts.has(w))) correct += 3;
                const nucleusParts = new Set([activity1Answers.word5, activity1Answers.word6]);
                if (nucleusParts.size === 2 && ['protons', 'neutrons'].every(w => nucleusParts.has(w))) correct += 2;
                if (activity1Answers.word7 === 'atom') correct++;
                if (activity1Answers.word8 === 'electrons') correct++;
                if (activity1Answers.word9 === 'Atoms') correct++;
                const percentage = Math.round((correct / 9) * 100);
                setActivity1Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 5);
                    if (!completedActivities.includes(1)) setCompletedActivities([...completedActivities, 1]);
                }
                setActivity1Checked(true);
            };

            const checkActivity2 = () => {
                let correct = Object.keys(activity2Correct).filter(key => activity2Answers[key] === activity2Correct[key]).length;
                const percentage = Math.round((correct / 3) * 100);
                setActivity2Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 10);
                    if (!completedActivities.includes(2)) setCompletedActivities([...completedActivities, 2]);
                }
                setActivity2Checked(true);
            };

            const checkActivity3 = () => {
                let correct = activity3Questions.filter(q => activity3Answers[q.num] === q.correct).length;
                const percentage = Math.round((correct / 20) * 100);
                setActivity3Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 5);
                    if (!completedActivities.includes(3)) setCompletedActivities([...completedActivities, 3]);
                }
                setActivity3Checked(true);
            };

            const checkActivity4 = () => {
                let correct = activity4Blanks.filter((word, idx) => activity4Answers[idx] === word).length;
                const percentage = Math.round((correct / 10) * 100);
                setActivity4Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 5 + 50);
                    if (!completedActivities.includes(4)) setCompletedActivities([...completedActivities, 4]);
                }
                setActivity4Checked(true);
            };

            const checkActivity6 = () => {
                let correct = Object.keys(activity6Correct).filter(key => activity6Answers[key] === activity6Correct[key]).length;
                const percentage = Math.round((correct / 3) * 100);
                setActivity6Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 15);
                    if (!completedActivities.includes(5)) setCompletedActivities([...completedActivities, 5]);
                }
                setActivity6Checked(true);
            };

            const checkActivity7 = () => {
                let correct = activity7Questions.filter(q => activity7Answers[q.id] === q.correct).length;
                const percentage = Math.round((correct / 5) * 100);
                setActivity7Score(percentage);
                if (percentage >= 75) {
                    setPoints(points + correct * 10);
                    if (!completedActivities.includes(6)) setCompletedActivities([...completedActivities, 6]);
                }
                setActivity7Checked(true);
            };

            const retryActivity1 = () => { setActivity1Answers({ word1: '', word2: '', word3: '', word4: '', word5: '', word6: '', word7: '', word8: '', word9: '' }); setActivity1Checked(false); setActivity1Score(null); setSelectedBlank1(null); };
            const retryActivity2 = () => { setActivity2Answers({ a: '', b: '', c: '' }); setActivity2Checked(false); setActivity2Score(null); };
            const retryActivity3 = () => { setActivity3Answers({}); setActivity3Checked(false); setActivity3Score(null); };
            const retryActivity4 = () => { setActivity4Answers({}); setActivity4Checked(false); setActivity4Score(null); setShowFlashcards(true); setFlippedCards({}); setSelectedBlank4(null); };
            const retryActivity6 = () => { setActivity6Answers({ para1: '', para2: '', para3: '' }); setActivity6Checked(false); setActivity6Score(null); };
            const retryActivity7 = () => { setActivity7Answers({}); setActivity7Checked(false); setActivity7Score(null); };

            const resetLesson = () => {
                setCurrentActivity(0); setPoints(0); setCompletedActivities([]);
                retryActivity1(); retryActivity2(); retryActivity3(); retryActivity4(); retryActivity6(); retryActivity7();
            };

            const downloadCertificate = () => {
                const win = window.open('', '', 'width=800,height=600');
                win.document.write(`<!DOCTYPE html><html><head><title>Certificate</title><style>body{font-family:Georgia,serif;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;background:linear-gradient(135deg,#667eea,#764ba2)}.certificate{background:white;padding:60px;border:20px solid #f4d03f;border-radius:20px;text-align:center}.trophy{font-size:80px}h1{color:#7c3aed;font-size:48px;font-weight:bold}.course-title{color:#7c3aed;font-size:28px;font-weight:bold;margin:30px 0;padding:20px;background:#f3f4f6;border-radius:10px}.score{font-size:36px;color:#059669;font-weight:bold;margin:30px 0;padding:20px;background:#d1fae5;border-radius:15px}</style></head><body><div class="certificate"><div class="trophy">üèÜ</div><h1>Certificate of Completion</h1><p>ESP 0103 - Electric Current - Reading 6</p><div class="score">Final Score: ${points} Points</div><p>‚≠ê ‚≠ê ‚≠ê</p><p>Higher Colleges of Technology</p><p>Designed by: Nazila Motahari</p></div></body></html>`);
                win.document.close();
                setTimeout(() => win.print(), 250);
            };

            const progressPercentage = (completedActivities.length / 6) * 100;

            const renderBlank1 = (blankKey, width = 'w-24') => {
                return (
                    <input 
                        type="text" 
                        value={activity1Answers[blankKey] || ''} 
                        onClick={() => {
                            if (!activity1Checked) {
                                if (activity1Answers[blankKey]) {
                                    const newAnswers = {...activity1Answers};
                                    newAnswers[blankKey] = '';
                                    setActivity1Answers(newAnswers);
                                } else {
                                    setSelectedBlank1(blankKey);
                                }
                            }
                        }} 
                        className={`inline-block ${width} px-2 py-1 border-b-2 text-center cursor-pointer ${
                            selectedBlank1 === blankKey ? 'border-blue-500 bg-blue-100' : 
                            activity1Checked ? 
                                (blankKey === 'word1' && activity1Answers[blankKey] === 'atom' ? 'border-green-500 bg-green-50' :
                                 blankKey === 'word7' && activity1Answers[blankKey] === 'atom' ? 'border-green-500 bg-green-50' :
                                 blankKey === 'word8' && activity1Answers[blankKey] === 'electrons' ? 'border-green-500 bg-green-50' :
                                 blankKey === 'word9' && activity1Answers[blankKey] === 'Atoms' ? 'border-green-500 bg-green-50' :
                                 ['word2', 'word3', 'word4'].includes(blankKey) && ['protons', 'neutrons', 'electrons'].includes(activity1Answers[blankKey]) ? 'border-green-500 bg-green-50' :
                                 ['word5', 'word6'].includes(blankKey) && ['protons', 'neutrons'].includes(activity1Answers[blankKey]) ? 'border-green-500 bg-green-50' :
                                 'border-red-500 bg-red-50') : 
                            'border-purple-300'
                        }`} 
                        disabled={activity1Checked} 
                        readOnly 
                    />
                );
            };

            const renderBlank4 = (index, width = 'w-24') => (
                <input 
                    type="text" 
                    value={activity4Answers[index] || ''} 
                    onClick={() => {
                        if (!activity4Checked) {
                            if (activity4Answers[index]) {
                                const newAnswers = {...activity4Answers}; 
                                delete newAnswers[index]; 
                                setActivity4Answers(newAnswers);
                            } else {
                                setSelectedBlank4(index);
                            }
                        }
                    }} 
                    className={`inline-block ${width} px-2 py-1 border-b-2 text-center cursor-pointer ${
                        selectedBlank4 === index ? 'border-blue-500 bg-blue-100' : 
                        activity4Checked ? (activity4Answers[index] === activity4Blanks[index] ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50') : 
                        'border-purple-300'
                    }`} 
                    disabled={activity4Checked} 
                    readOnly 
                />
            );

            const Icon = ({ icon: IconComponent, ...props }) => {
                React.useEffect(() => {
                    lucide.createIcons();
                }, []);
                return <i data-lucide={IconComponent.toLowerCase()} {...props}></i>;
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100 p-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-2xl font-bold text-purple-700 flex items-center gap-2">
                                        <Icon icon="zap" className="text-yellow-500" size={36} />
                                        ESP 0103 - Electric Current - Reading 6
                                    </h1>
                                    <p className="text-sm text-gray-600">Higher Colleges of Technology</p>
                                    <p className="text-xs text-gray-500">Designed by: Nazila Motahari</p>
                                </div>
                                <div className="text-right">
                                    <div className="text-2xl font-bold text-purple-600">{points} pts</div>
                                    <div className="text-sm text-gray-600">Total Points</div>
                                </div>
                            </div>
                            <div className="mb-4">
                                <div className="flex justify-between text-sm mb-1">
                                    <span className="text-gray-600">Progress</span>
                                    <span className="text-purple-600 font-semibold">{completedActivities.length}/6 Activities</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-3">
                                    <div className="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500" style={{ width: `${progressPercentage}%` }}></div>
                                </div>
                            </div>
                            <div className="flex gap-2 flex-wrap">
                                {[1, 2, 3, 4, 5, 6].map((num) => (
                                    <button key={num} onClick={() => setCurrentActivity(num - 1)} className={`px-4 py-2 rounded-lg font-semibold transition ${currentActivity === num - 1 ? 'bg-purple-600 text-white' : completedActivities.includes(num) ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>
                                        {completedActivities.includes(num) && '‚úì '}Activity {num}
                                    </button>
                                ))}
                            </div>
                            {completedActivities.length === 6 && (
                                <div className="mt-4 p-4 bg-green-100 rounded-lg border-2 border-green-500">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-xl font-bold text-green-700 flex items-center gap-2">
                                                <Icon icon="trophy" size={24} />
                                                Congratulations! All Activities Completed!
                                            </p>
                                            <p className="text-green-600">Total Score: {points} points</p>
                                        </div>
                                        <button onClick={downloadCertificate} className="px-6 py-3 bg-green-600 text-white rounded-lg flex items-center gap-2 hover:bg-green-700">
                                            <Icon icon="download" size={20} />
                                            Download Certificate
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-8 mb-6 min-h-96">
                            {/* Activity 1 */}
                            {currentActivity === 0 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 1: Understanding Atoms</h2>
                                    <div className="bg-blue-50 p-6 rounded-lg">
                                        <h3 className="font-bold mb-4">Word Bank:</h3>
                                        <div className="flex flex-wrap gap-2 mb-4">
                                            {activity1WordBank.map((word, idx) => {
                                                const used = Object.values(activity1Answers).filter(w => w === word).length;
                                                const canUse = used < activity1WordCounts[word];
                                                return (
                                                    <button 
                                                        key={idx} 
                                                        onClick={() => {
                                                            if (canUse && selectedBlank1 !== null) {
                                                                setActivity1Answers({...activity1Answers, [selectedBlank1]: word});
                                                                setSelectedBlank1(null);
                                                            }
                                                        }} 
                                                        className={`px-4 py-2 rounded-lg font-semibold ${!canUse ? 'bg-gray-300 text-gray-500' : 'bg-purple-500 text-white hover:bg-purple-600'}`}
                                                        disabled={activity1Checked || !canUse}
                                                    >
                                                        {word} ({activity1WordCounts[word] - used}/{activity1WordCounts[word]})
                                                    </button>
                                                );
                                            })}
                                        </div>
                                        <button 
                                            onClick={() => {setActivity1Answers({ word1: '', word2: '', word3: '', word4: '', word5: '', word6: '', word7: '', word8: '', word9: '' }); setSelectedBlank1(null);}} 
                                            disabled={activity1Checked}
                                            className="px-4 py-2 bg-red-500 text-white rounded-lg mb-4 disabled:bg-gray-300"
                                        >
                                            Clear All
                                        </button>
                                        <p className="text-lg leading-relaxed">
                                            Everything in the universe is made of tiny particles called {renderBlank1('word1', 'w-28')}s. 
                                            An atom has three main parts: {renderBlank1('word2', 'w-28')}, {renderBlank1('word3', 'w-28')}, 
                                            and {renderBlank1('word4', 'w-28')}. The center of an atom is called the nucleus. 
                                            The nucleus contains {renderBlank1('word5', 'w-28')} and {renderBlank1('word6', 'w-28')}. 
                                            Around the outside of the {renderBlank1('word7', 'w-28')}, {renderBlank1('word8', 'w-28')} move 
                                            in orbits. {renderBlank1('word9', 'w-28')} are the building blocks of everything we see.
                                        </p>
                                    </div>
                                    {!activity1Checked ? (
                                        <button onClick={checkActivity1} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">
                                            Check Answers
                                        </button>
                                    ) : (
                                        <div className="space-y-4">
                                            <div className={`p-4 rounded-lg ${activity1Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                <p className="text-xl font-bold">{activity1Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                <p className="text-lg">Score: {activity1Score}%</p>
                                                {activity1Score >= 75 && <p className="text-green-600">+{Math.round(activity1Score / 100 * 9) * 5} points earned!</p>}
                                            </div>
                                            {activity1Score < 75 && (
                                                <button onClick={retryActivity1} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                    <Icon icon="refresh-cw" size={20} />
                                                    Try Again
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Activity 2 */}
                            {currentActivity === 1 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 2: Particle Charges</h2>
                                    <div className="bg-green-50 p-6 rounded-lg space-y-4">
                                        <div className="space-y-2">
                                            <label className="font-semibold">a) Which particles have a positive charge?</label>
                                            <select 
                                                value={activity2Answers.a} 
                                                onChange={(e) => setActivity2Answers({...activity2Answers, a: e.target.value})}
                                                disabled={activity2Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select an answer...</option>
                                                <option value="protons">Protons</option>
                                                <option value="electrons">Electrons</option>
                                                <option value="Neutrons">Neutrons</option>
                                            </select>
                                            {activity2Checked && (
                                                <p className={activity2Answers.a === activity2Correct.a ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity2Answers.a === activity2Correct.a ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity2Correct.a}`}
                                                </p>
                                            )}
                                        </div>

                                        <div className="space-y-2">
                                            <label className="font-semibold">b) Which particles have a negative charge?</label>
                                            <select 
                                                value={activity2Answers.b} 
                                                onChange={(e) => setActivity2Answers({...activity2Answers, b: e.target.value})}
                                                disabled={activity2Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select an answer...</option>
                                                <option value="protons">Protons</option>
                                                <option value="electrons">Electrons</option>
                                                <option value="Neutrons">Neutrons</option>
                                            </select>
                                            {activity2Checked && (
                                                <p className={activity2Answers.b === activity2Correct.b ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity2Answers.b === activity2Correct.b ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity2Correct.b}`}
                                                </p>
                                            )}
                                        </div>

                                        <div className="space-y-2">
                                            <label className="font-semibold">c) Which particles have no charge?</label>
                                            <select 
                                                value={activity2Answers.c} 
                                                onChange={(e) => setActivity2Answers({...activity2Answers, c: e.target.value})}
                                                disabled={activity2Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select an answer...</option>
                                                <option value="protons">Protons</option>
                                                <option value="electrons">Electrons</option>
                                                <option value="Neutrons">Neutrons</option>
                                            </select>
                                            {activity2Checked && (
                                                <p className={activity2Answers.c === activity2Correct.c ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity2Answers.c === activity2Correct.c ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity2Correct.c}`}
                                                </p>
                                            )}
                                        </div>
                                    </div>

                                    {!activity2Checked ? (
                                        <button onClick={checkActivity2} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">
                                            Check Answers
                                        </button>
                                    ) : (
                                        <div className="space-y-4">
                                            <div className={`p-4 rounded-lg ${activity2Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                <p className="text-xl font-bold">{activity2Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                <p className="text-lg">Score: {activity2Score}%</p>
                                                {activity2Score >= 75 && <p className="text-green-600">+{Object.keys(activity2Correct).filter(k => activity2Answers[k] === activity2Correct[k]).length * 10} points earned!</p>}
                                            </div>
                                            {activity2Score < 75 && (
                                                <button onClick={retryActivity2} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                    <Icon icon="refresh-cw" size={20} />
                                                    Try Again
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Activity 3 - Reading Comprehension with embedded word choices */}
                            {currentActivity === 2 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 3: Reading Comprehension</h2>
                                    <p className="text-gray-700">Choose the best word for each blank in the readings below:</p>
                                    
                                    <div className="bg-yellow-50 p-6 rounded-lg space-y-6">
                                        <h3 className="font-bold text-lg">Paragraph 1: What is electricity?</h3>
                                        <div className="bg-white p-6 rounded-lg text-base leading-relaxed">
                                            <p className="inline">
                                                {/* Questions 1-12 embedded in paragraph 1 */}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[0].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [1]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[1] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[0].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}is the flow of very small things called{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[1].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [2]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[2] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[1].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                . It can also mean the{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[2].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [3]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[3] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[2].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}you get when electrons{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[3].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [4]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[4] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[3].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}from place to place. We can see{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[4].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [5]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[5] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[4].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}in nature when there is a bolt of{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[5].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [6]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[6] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[5].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}in the sky. This is just a large number of{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[6].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [7]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[7] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[6].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}moving through air at the same time, making a huge amount of{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[7].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [8]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[8] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[7].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                . Scientists have also learned how to{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[8].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [9]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[9] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[8].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                , or make, electricity. This can be controlled and sent through{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[9].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [10]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[10] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[9].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                . It can then{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[10].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [11]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[11] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[10].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}such things as heaters, light bulbs, and computers. Today, electricity{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[11].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [12]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[12] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[11].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}most of the energy to run the modern world.
                                            </p>
                                        </div>

                                        <h3 className="font-bold text-lg mt-8">Paragraph 2: How electricity works</h3>
                                        <div className="bg-white p-6 rounded-lg text-base leading-relaxed">
                                            <p className="inline">
                                                Everything in the{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[12].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [13]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[13] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[12].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}is made of tiny objects called{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[13].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [14]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[14] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[13].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                . Each one has even smaller particles called protons and electrons. An electron has what is called a{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[14].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [15]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[15] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[14].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}charge. A proton has a positive{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[15].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [16]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[16] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[15].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                . Negative and{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[16].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [17]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[17] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[16].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}charges try to pull each other together. However, two positive, or two negative{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[17].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [18]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[18] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[17].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                , will push each other away.{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[18].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [19]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[19] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[18].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}results when{' '}
                                                <span className="inline-flex gap-2 mx-1">
                                                    {activity3Questions[19].options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity3Answers({...activity3Answers, [20]: opt})}
                                                            disabled={activity3Checked}
                                                            className={`px-2 py-1 rounded border-2 text-sm font-semibold ${
                                                                activity3Answers[20] === opt 
                                                                    ? activity3Checked 
                                                                        ? opt === activity3Questions[19].correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </span>
                                                {' '}are pushed and pulled from atom to atom.
                                            </p>
                                        </div>
                                    </div>

                                    {!activity3Checked ? (
                                        <button onClick={checkActivity3} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">
                                            Check Answers
                                        </button>
                                    ) : (
                                        <div className="space-y-4">
                                            <div className={`p-4 rounded-lg ${activity3Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                <p className="text-xl font-bold">{activity3Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                <p className="text-lg">Score: {activity3Score}%</p>
                                                {activity3Score >= 75 && <p className="text-green-600">+{activity3Questions.filter(q => activity3Answers[q.num] === q.correct).length * 5} points earned!</p>}
                                            </div>
                                            {activity3Score < 75 && (
                                                <button onClick={retryActivity3} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                    <Icon icon="refresh-cw" size={20} />
                                                    Try Again
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Activity 4 - Vocabulary & Paragraph */}
                            {currentActivity === 3 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 4: Vocabulary & Paragraph</h2>
                                    {showFlashcards ? (
                                        <div>
                                            <h3 className="font-bold mb-4">Study Flashcards (click to flip):</h3>
                                            <div className="grid grid-cols-2 gap-4 mb-4">
                                                {vocabularyCards.map((card, idx) => (
                                                    <div key={idx} onClick={() => setFlippedCards({...flippedCards, [idx]: !flippedCards[idx]})} className="cursor-pointer h-48" style={{perspective: '1000px'}}>
                                                        <div className="relative w-full h-full transition-transform duration-500" style={{transformStyle: 'preserve-3d', transform: flippedCards[idx] ? 'rotateY(180deg)' : 'rotateY(0deg)'}}>
                                                            <div className="absolute w-full h-full bg-purple-500 text-white p-6 rounded-lg flex flex-col justify-center items-center" style={{backfaceVisibility: 'hidden'}}>
                                                                <p className="text-2xl font-bold">{card.word}</p>
                                                            </div>
                                                            <div className="absolute w-full h-full bg-blue-500 text-white p-6 rounded-lg flex flex-col justify-center" style={{backfaceVisibility: 'hidden', transform: 'rotateY(180deg)'}}>
                                                                <p className="text-xl font-bold mb-2">{card.word}</p>
                                                                <p className="italic">{card.meaning}</p>
                                                                <p className="text-2xl mt-2">{card.arabic}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                            <button onClick={() => setShowFlashcards(false)} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">Continue to Exercise</button>
                                        </div>
                                    ) : (
                                        <div>
                                            <h3 className="font-bold mb-2">Word Bank:</h3>
                                            <div className="flex flex-wrap gap-2 p-4 bg-gray-100 rounded mb-4">
                                                {activity4WordBank.map((word, idx) => {
                                                    const used = Object.values(activity4Answers).filter(w => w === word).length;
                                                    const canUse = used < activity4WordCounts[word];
                                                    return (
                                                        <button key={idx} onClick={() => {
                                                            if (canUse && selectedBlank4 !== null) {
                                                                setActivity4Answers({...activity4Answers, [selectedBlank4]: word});
                                                                setSelectedBlank4(null);
                                                            }
                                                        }} className={`px-3 py-2 rounded ${!canUse ? 'bg-gray-300 text-gray-500' : 'bg-purple-500 text-white hover:bg-purple-600'}`} disabled={activity4Checked || !canUse}>
                                                            {word}
                                                        </button>
                                                    );
                                                })}
                                            </div>
                                            <button onClick={() => {setActivity4Answers({}); setSelectedBlank4(null);}} disabled={activity4Checked} className="px-4 py-2 bg-red-500 text-white rounded mb-4 disabled:bg-gray-300">Clear All</button>
                                            <div className="bg-green-50 p-6 rounded-lg">
                                                <h3 className="font-bold mb-4">Paragraph 3: Generating electricity</h3>
                                                <p className="text-lg leading-relaxed">
                                                    To bring {renderBlank4(0)} to our homes, large {renderBlank4(1)} create a strong electric {renderBlank4(2)}. This flows through thick {renderBlank4(3)} to our neighborhoods. In our houses, we find wall {renderBlank4(4)} where we can connect our electronics. When you {renderBlank4(5, 'w-28')} a {renderBlank4(6)}, the electricity makes it work. Many household {renderBlank4(7, 'w-32')} need electricity. Inside a generator, a {renderBlank4(8)} moves near a {renderBlank4(9)} of wire to create the flow of electrons.
                                                </p>
                                            </div>
                                            <div className="mt-4 flex gap-4">
                                                <button onClick={() => setShowFlashcards(true)} className="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600">Review Vocabulary</button>
                                                {!activity4Checked && <button onClick={checkActivity4} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">Check Answers</button>}
                                            </div>
                                            {activity4Checked && (
                                                <div className="mt-4 space-y-4">
                                                    <div className={`p-4 rounded-lg ${activity4Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                        <p className="text-xl font-bold">{activity4Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                        <p className="text-lg">Score: {activity4Score}%</p>
                                                        {activity4Score >= 75 && <p className="text-green-600">+{activity4Blanks.filter((w, i) => activity4Answers[i] === w).length * 5 + 50} points earned!</p>}
                                                    </div>
                                                    {activity4Score < 75 && (
                                                        <button onClick={retryActivity4} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                            <Icon icon="refresh-cw" size={20} />
                                                            Try Again
                                                        </button>
                                                    )}
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Activity 5 - Match Headings (previously Activity 6) */}
                            {currentActivity === 4 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 5: Match Headings</h2>
                                    <div className="bg-indigo-50 p-6 rounded-lg space-y-6">
                                        <div className="space-y-2">
                                            <h3 className="font-bold">Paragraph 1:</h3>
                                            <p className="bg-white p-4 rounded-lg">
                                                Electricity is the flow of electrons from one place to another. We can see electricity in nature when lightning strikes. Lightning is when many electrons move through the air all at once. Scientists learned to make electricity and send it through wires. Now we use electricity every day to power heaters, light bulbs, and computers.
                                            </p>
                                            <select 
                                                value={activity6Answers.para1} 
                                                onChange={(e) => setActivity6Answers({...activity6Answers, para1: e.target.value})}
                                                disabled={activity6Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select a heading...</option>
                                                {activity6Headings.map((heading, idx) => (
                                                    <option key={idx} value={heading}>{heading}</option>
                                                ))}
                                            </select>
                                            {activity6Checked && (
                                                <p className={activity6Answers.para1 === activity6Correct.para1 ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity6Answers.para1 === activity6Correct.para1 ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity6Correct.para1}`}
                                                </p>
                                            )}
                                        </div>

                                        <div className="space-y-2">
                                            <h3 className="font-bold">Paragraph 2:</h3>
                                            <p className="bg-white p-4 rounded-lg">
                                                Electrons move because they want to balance their charge. Some materials let electrons flow easily through them - we call these conductors. When electrons flow through a wire, we call this an electric current. A battery provides energy to push electrons through a circuit. When you flip a switch, you complete a path for electrons to travel.
                                            </p>
                                            <select 
                                                value={activity6Answers.para2} 
                                                onChange={(e) => setActivity6Answers({...activity6Answers, para2: e.target.value})}
                                                disabled={activity6Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select a heading...</option>
                                                {activity6Headings.map((heading, idx) => (
                                                    <option key={idx} value={heading}>{heading}</option>
                                                ))}
                                            </select>
                                            {activity6Checked && (
                                                <p className={activity6Answers.para2 === activity6Correct.para2 ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity6Answers.para2 === activity6Correct.para2 ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity6Correct.para2}`}
                                                </p>
                                            )}
                                        </div>

                                        <div className="space-y-2">
                                            <h3 className="font-bold">Paragraph 3:</h3>
                                            <p className="bg-white p-4 rounded-lg">
                                                To bring power to our homes, large generators create a strong electric current. This flows through thick wires to our neighborhoods. In our houses, we find wall outlets where we can connect our electronics. When you plug in a device, the electricity makes it work. Many household appliances need electricity. Inside a generator, a magnet moves near a coil of wire to create the flow of electrons.
                                            </p>
                                            <select 
                                                value={activity6Answers.para3} 
                                                onChange={(e) => setActivity6Answers({...activity6Answers, para3: e.target.value})}
                                                disabled={activity6Checked}
                                                className="w-full p-2 border-2 border-purple-300 rounded-lg"
                                            >
                                                <option value="">Select a heading...</option>
                                                {activity6Headings.map((heading, idx) => (
                                                    <option key={idx} value={heading}>{heading}</option>
                                                ))}
                                            </select>
                                            {activity6Checked && (
                                                <p className={activity6Answers.para3 === activity6Correct.para3 ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>
                                                    {activity6Answers.para3 === activity6Correct.para3 ? '‚úì Correct!' : `‚úó Incorrect. Correct answer: ${activity6Correct.para3}`}
                                                </p>
                                            )}
                                        </div>
                                    </div>

                                    {!activity6Checked ? (
                                        <button onClick={checkActivity6} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">
                                            Check Answers
                                        </button>
                                    ) : (
                                        <div className="space-y-4">
                                            <div className={`p-4 rounded-lg ${activity6Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                <p className="text-xl font-bold">{activity6Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                <p className="text-lg">Score: {activity6Score}%</p>
                                                {activity6Score >= 75 && <p className="text-green-600">+{Object.keys(activity6Correct).filter(k => activity6Answers[k] === activity6Correct[k]).length * 15} points earned!</p>}
                                            </div>
                                            {activity6Score < 75 && (
                                                <button onClick={retryActivity6} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                    <Icon icon="refresh-cw" size={20} />
                                                    Try Again
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Activity 6 - Comprehension Quiz (previously Activity 7) */}
                            {currentActivity === 5 && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-purple-700">Activity 6: Comprehension Quiz</h2>
                                    <div className="bg-teal-50 p-6 rounded-lg space-y-6">
                                        {activity7Questions.map((q) => (
                                            <div key={q.id} className="bg-white p-4 rounded-lg">
                                                <p className="font-semibold mb-3">{q.id}. {q.question}</p>
                                                <div className="space-y-2">
                                                    {q.options.map((opt, idx) => (
                                                        <button
                                                            key={idx}
                                                            onClick={() => setActivity7Answers({...activity7Answers, [q.id]: opt})}
                                                            disabled={activity7Checked}
                                                            className={`w-full text-left px-4 py-3 rounded-lg border-2 transition ${
                                                                activity7Answers[q.id] === opt 
                                                                    ? activity7Checked 
                                                                        ? opt === q.correct 
                                                                            ? 'bg-green-100 border-green-500' 
                                                                            : 'bg-red-100 border-red-500'
                                                                        : 'bg-purple-100 border-purple-500'
                                                                    : 'border-gray-300 hover:border-purple-300 hover:bg-gray-50'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    ))}
                                                </div>
                                                {activity7Checked && activity7Answers[q.id] !== q.correct && (
                                                    <p className="text-red-600 mt-2 font-semibold">Correct answer: {q.correct}</p>
                                                )}
                                            </div>
                                        ))}
                                    </div>

                                    {!activity7Checked ? (
                                        <button onClick={checkActivity7} className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700">
                                            Check Answers
                                        </button>
                                    ) : (
                                        <div className="space-y-4">
                                            <div className={`p-4 rounded-lg ${activity7Score >= 75 ? 'bg-green-100 border-2 border-green-500' : 'bg-orange-100 border-2 border-orange-500'}`}>
                                                <p className="text-xl font-bold">{activity7Score >= 75 ? '‚úì Great job!' : '‚ö† Keep practicing!'}</p>
                                                <p className="text-lg">Score: {activity7Score}%</p>
                                                {activity7Score >= 75 && <p className="text-green-600">+{activity7Questions.filter(q => activity7Answers[q.id] === q.correct).length * 10} points earned!</p>}
                                            </div>
                                            {activity7Score < 75 && (
                                                <button onClick={retryActivity7} className="px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold flex items-center gap-2">
                                                    <Icon icon="refresh-cw" size={20} />
                                                    Try Again
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>

                        <div className="flex justify-between">
                            <button onClick={() => setCurrentActivity(Math.max(0, currentActivity - 1))} disabled={currentActivity === 0} className="px-6 py-3 bg-gray-500 text-white rounded-lg disabled:bg-gray-300 hover:bg-gray-600">Previous Activity</button>
                            <button onClick={resetLesson} className="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600">Reset All</button>
                            <button onClick={() => setCurrentActivity(Math.min(5, currentActivity + 1))} disabled={currentActivity === 5} className="px-6 py-3 bg-purple-600 text-white rounded-lg disabled:bg-gray-300 hover:bg-purple-700">Next Activity</button>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ElectricCurrentLesson />, document.getElementById('root'));
    </script>
</body>
</html>
